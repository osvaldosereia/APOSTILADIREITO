<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>direito.love ‚Äî Gerador de Prompts</title>
  <style>
    :root{
      --bg:#f6f7fb; --panel:#ffffff; --ink:#0f172a; --muted:#6b7280; --border:#e5e7eb;
      --primary:#0ea5e9; --chip:#eef6ff;
      /* vari√°vel para teclado (fallback tamb√©m usa) */
      --kb: 64px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--ink); background:linear-gradient(180deg,#f9fbff,#f5f7fb 40%,#eef2f7)
    }
    .wrap{min-height:100dvh; display:flex; align-items:center; justify-content:center; padding:24px}
    .phone{width:100%; max-width:440px; background:var(--panel); border:1px solid var(--border);
      border-radius:24px; box-shadow:0 10px 30px rgba(15,23,42,.08); overflow:hidden; position:relative}
    .topbar{display:flex; align-items:center; justify-content:space-between; gap:12px; padding:14px 16px;
      border-bottom:1px solid var(--border); background:#fff; position:sticky; top:0; z-index:30}
    .brand{font-weight:800; font-size:18px; letter-spacing:.2px}
    .insta{display:inline-flex; align-items:center; justify-content:center; width:28px; height:28px; border-radius:8px;
      text-decoration:none; background:radial-gradient(120% 120% at 10% 10%,#f9ce34,#ee2a7b 60%,#6228d7); box-shadow:0 1px 4px rgba(0,0,0,.08)}
    .insta svg{width:16px; height:16px; color:#fff}

    .chat{
      padding:16px; display:flex; flex-direction:column; gap:10px; height:560px; overflow:auto; scroll-behavior:smooth;
      background:linear-gradient(180deg,#fff 0,#fff 40%, #f9fafb);
      padding-bottom:calc(var(--kb) + 96px);
    }
    .bubble{max-width:85%; padding:12px 14px; border-radius:16px; font-size:14px; line-height:1.48; box-shadow:0 2px 12px rgba(2,6,23,.06)}
    .bot{align-self:flex-start; background:#f7fafc; border:1px solid var(--border)}
    .user{align-self:flex-end; background:#0ea5e9; color:#fff}

    .typing{display:inline-flex; gap:6px; align-items:center}
    .dot{width:6px; height:6px; border-radius:50%; background:#9ca3af; opacity:.6; animation:blink 1s infinite}
    .dot:nth-child(2){animation-delay:.2s} .dot:nth-child(3){animation-delay:.4s}
    @keyframes blink{0%,60%{opacity:.2} 30%{opacity:1}}

    .options{display:flex; flex-direction:column; gap:8px; margin-top:6px}
    .chip{border:1px solid var(--border); background:var(--chip); color:#0b3b4a; padding:9px 12px; border-radius:12px; font-size:13px; cursor:pointer; text-align:left}
    .chip:hover{filter:brightness(.98)} .chip:active{transform:scale(.98)}
    .chip.cta{background:var(--primary); color:#fff; border-color:var(--primary); font-weight:700; text-align:center; box-shadow:0 6px 18px rgba(14,165,233,.25)}
    .options .chip.cta{align-self:stretch}

    .small{font-size:12px; color:var(--muted)}

    /* Composer flutuante ‚Äî usa var(--kb) para subir com teclado */
    .composer{
      position:absolute; left:50%; transform:translateX(-50%);
      bottom:var(--kb); width:80%; background:#fff; border:1px solid var(--border); border-radius:16px;
      box-shadow:0 8px 24px rgba(15,23,42,.08); padding:8px; display:flex; gap:8px; align-items:center; z-index:20
    }
    .composer input{flex:1; border:0; outline:none; background:transparent; font-size:14px; padding:10px 8px}
    .composer button{border:0; padding:10px 14px; border-radius:12px; background:var(--primary); color:#fff; font-weight:600; cursor:pointer}

    .footer{padding:12px 16px; border-top:1px solid var(--border); background:#fff; display:flex; align-items:center; justify-content:center}
    pre{white-space:pre-wrap; word-break:break-word; background:#0b1220; color:#e5e7eb; padding:14px; border-radius:12px; font-size:12.5px}
    .copy{margin-top:8px; background:#111827; color:#fff; border:0; padding:10px 12px; border-radius:12px; font-size:12.5px; cursor:pointer}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="phone" role="region" aria-label="Chatbot Jur√≠dico ‚Äî MVP">
      <div class="topbar">
        <div class="brand">direito.love</div>
        <a class="insta" href="https://instagram.com/osvaldosereiajr" target="_blank" rel="noopener" aria-label="Instagram @osvaldosereiajr">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
            <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
            <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
          </svg>
        </a>
      </div>

      <div id="chat" class="chat" aria-live="polite"></div>

      <div class="composer" aria-label="Entrada de tema">
        <input id="tema" placeholder="Digite um tema (ex.: Furto ‚Äì art. 155)" />
        <button id="send">Enviar</button>
      </div>

      <div class="footer"><span class="small">Simula√ß√£o ‚Ä¢ tema ‚Üí escolhas ‚Üí prompt</span></div>
    </div>
  </div>

  <script>
  // ===== Utils =====
  const tzGreeting = ()=>{ try{ const h=new Date().getHours(); return h<12?'bom dia! üëã': h<18?'boa tarde! üëã':'boa noite! üëã'; }catch(_){ return 'ol√°! üëã'; } };
  const sleep = (ms)=> new Promise(r=>setTimeout(r,ms));
  const chat = document.getElementById('chat');
  const temaInput = document.getElementById('tema');
  const sendBtn = document.getElementById('send');
  function el(tag, cls, html){ const n=document.createElement(tag); if(cls) n.className=cls; if(html!==undefined) n.innerHTML=html; return n; }
  function scrollBottom(){ chat.scrollTop = chat.scrollHeight; }
  function bubble(html, who='bot'){ const b=el('div',`bubble ${who}`,html); chat.appendChild(b); scrollBottom(); return b; }
  function typing(){ const t=el('div','bubble bot'); const w=el('div','typing'); w.appendChild(el('span','dot')); w.appendChild(el('span','dot')); w.appendChild(el('span','dot')); t.appendChild(w); chat.appendChild(t); scrollBottom(); return t; }
  async function showThinking(ms=1700){ const t=typing(); await sleep(ms); t.remove(); }
  async function botSay(html, delayMs=1600){ const t=typing(); await sleep(delayMs); t.remove(); bubble(html,'bot'); }

  // ===== Constantes do fluxo gen√©rico =====
  const DEPTH=[
    'Explica√ß√£o R√°pida (Matar Curiosidade)',
    'Explica√ß√£o Detalhada (Professor dos Bons)',
    'Pesquisa Aprofundada (Se ler tudo vira mestre)'
  ];
  const MUST=['Checklist','Tabelas','Caso concreto','Quest√µes','Compara√ß√µes','Exemplos pr√°ticos']; // at√© 2
  const JURIS=['N√£o precisa','Se vier certa, eu quero','Tem que ter'];

  // ===== Estado =====
  const state={ tema:'', depth:null, must:new Set(), juris:null, phase:'idle' };

  // ===== Fluxo =====
  async function greet(){
    await botSay(tzGreeting());
    // quebra-gelo (1x/dia)
    try{
      const ICE=[
        'prometo n√£o falar latim sem necessidade üòâ',
        'ops‚Ä¶ comecei a cantar no meio do expediente üé∂ j√° voltei! qual o tema?',
        'hoje √© zero decoreba, 100% entendimento. qual assunto atacamos?',
        'o juridiqu√™s vai entrar aqui e sair traduzido. tema, por favor?',
        'pode mandar um tema feio/confuso. eu organizo tudo.',
        'se eu errar, a culpa √© do autocorretor jur√≠dico üòÖ. qual o tema?',
        'bora fazer um sum√°rio t√£o claro que at√© o seu eu do futuro agradece?',
        'trouxe caf√©, foco e boa vontade. voc√™ traz o tema?',
        'prometo n√£o usar latim sem necessidade (s√≥ se for muito estiloso). qual o tema?',
        'ops‚Ä¶ me distrai com um meme de s√∫mula ü§¶‚Äç‚ôÇÔ∏è voltei! qual o tema?'
      ];
      const today=new Date().toISOString().slice(0,10);
      const last=localStorage.getItem('ice_day');
      let msg=null;
      if(last!==today){ const idx=Math.floor(Math.random()*ICE.length); localStorage.setItem('ice_day',today); localStorage.setItem('ice_idx',String(idx)); msg=ICE[idx]; }
      else{ const idx=Number(localStorage.getItem('ice_idx')||'0'); msg=ICE[idx%ICE.length]; }
      await botSay(msg);
    }catch(_){}
    await botSay('qual tema voc√™ quer estudar hoje? <span class="small">(ex.: ‚Äúfurto ‚Äì art. 155‚Äù, ‚Äútutela de urg√™ncia‚Äù, ‚Äúcontrole de constitucionalidade‚Äù)</span>');
    state.phase='ask_tema';
  }

  async function askDepth(){
    bubble('<strong>N√≠vel de Profundidade</strong>','bot');
    await showThinking(1700);
    const box=el('div','options');
    DEPTH.forEach((label,idx)=>{
      const b=el('button','chip',label);
      b.addEventListener('click',()=>{ state.depth=idx; bubble(label,'user'); box.remove(); askMust(); });
      box.appendChild(b);
    });
    chat.appendChild(box); scrollBottom();
  }

  async function askMust(){
    bubble('<strong>O que n√£o pode faltar na sua resposta?</strong> <span class="small">(at√© 2 itens)</span>','bot');
    await showThinking(1700);
    const box=el('div','options');
    const hint=el('div','small','restam 2 escolhas'); box.appendChild(hint);
    MUST.forEach((label)=>{
      const b=el('button','chip',label);
      b.addEventListener('click',()=>{
        if(state.must.has(label)){ state.must.delete(label); b.style.opacity=''; }
        else{ if(state.must.size>=2){ return; } state.must.add(label); b.style.opacity='.75'; }
        const rest = 2 - state.must.size; hint.textContent = `restam ${rest} escolha${rest===1?'':'s'}`;
      });
      box.appendChild(b);
    });
    const cont=el('button','chip cta','Continuar ‚Üí');
    cont.addEventListener('click',()=>{ bubble([...state.must].join(', ')||'Sem prefer√™ncias','user'); box.remove(); askJuris(); });
    box.appendChild(cont);
    chat.appendChild(box); scrollBottom();
  }

  async function askJuris(){
    bubble('<strong>Sobre jurisprud√™ncias, s√∫mulas e enunciados</strong>','bot');
    await showThinking(1700);
    const box=el('div','options');
    JURIS.forEach((label,idx)=>{
      const b=el('button','chip',label);
      b.addEventListener('click',()=>{ state.juris=idx; bubble(label,'user'); box.remove(); showNoteAndCTA(); });
      box.appendChild(b);
    });
    chat.appendChild(box); scrollBottom();
  }

  async function showNoteAndCTA(){
    await botSay('<strong>Observa√ß√£o importante</strong><br>Nossos prompts s√£o para te transformar em um mestre em Direito. A gente te ajuda a estudar. Por isso as respostas t√™m linguagem simples, para facilitar a compreens√£o e a memoriza√ß√£o.');
    bubble('tudo pronto?','bot');
    await showThinking(1700);
    const box=el('div','options');
    const go=el('button','chip cta','Gerar prompt');
    go.addEventListener('click',()=>{ box.remove(); finalizePrompt(); });
    box.appendChild(go);
    chat.appendChild(box); scrollBottom();
  }

  function mustRules(){
    const arr=[...state.must]; if(arr.length===0) return '';
    const map={
      'Checklist':'- Inclua um checklist de 5 passos para analisar o tema.\n',
      'Tabelas':'- Se houver compara√ß√µes, apresente um quadro/tabela para sintetizar as diferen√ßas.\n',
      'Caso concreto':'- Traga pelo menos 1 caso concreto (mini-caso) resolvido em 3‚Äì5 linhas.\n',
      'Quest√µes':'- Inclua 1 quest√£o objetiva (com gabarito) e 1 discursiva curta (com espelho).\n',
      'Compara√ß√µes':'- Compare com institutos pr√≥ximos para evitar confus√µes cl√°ssicas.\n',
      'Exemplos pr√°ticos':'- D√™ exemplos pr√°ticos al√©m do caso, para fixa√ß√£o de conceitos.\n',
    }; return arr.map(x=>map[x]).join('');
  }

  function buildPrompt(){
    const tema = state.tema || 'Tema jur√≠dico';
    const depthIdx = state.depth ?? 1;
    const depthLabel = DEPTH[depthIdx];
    const jurisLabel = JURIS[state.juris ?? 1];
    const mustArr = [...state.must];

    // Curto (para N√≠vel = R√°pida)
    const short =
`Explique **${tema}** como professor de Direito, em ${depthLabel}.
Estrutura: Diagn√≥stico ‚Üí Sum√°rio ‚Üí Desenvolver s√≥ o 1¬∫ item ‚Üí Resumo (5 pontos) ‚Üí ‚ÄúContinuar?‚Äù.
${mustArr.length?`Extras (at√© 2): ${mustArr.join(', ')}.\n`:''}JURIS=${jurisLabel}: inclua somente com link (ConJur/Migalhas/JOTA/√Çmbito/JusBrasil; Planalto apenas p/ texto legal).
Se n√£o achar com seguran√ßa, avise e sugira checagem oficial.`;

    // Avan√ßado (para N√≠vel = Detalhada/Aprofundada)
    const advanced =
`Voc√™ √© professor universit√°rio de Direito.
Explique o tema **${tema}** com alta qualidade pedag√≥gica, seguindo as regras abaixo.

## 1) Estilo e profundidade
${depthIdx===0?`- Resposta r√°pida: essencial em 200‚Äì300 palavras; sem jarg√£o.`:(depthIdx===1?`- Explica√ß√£o detalhada: did√°tica completa com exemplos √∫teis (600‚Äì900 palavras).`:`- Pesquisa aprofundada: an√°lise densa (1000‚Äì1400 palavras) com nuances e diverg√™ncias quando existirem.`)}
Linguagem clara e simples. Formate em **Markdown** (t√≠tulos, listas e, quando aplic√°vel, tabelas).

## 2) Estrutura m√≠nima (sempre)
1. **Diagn√≥stico do tema**: classe (material/processual/jurisprudencial/misto), base legal principal e confus√µes comuns.
2. **Sum√°rio estrat√©gico**: s√≥ t√≥picos pertinentes (sem encher lingui√ßa).
3. **Desenvolvimento do 1¬∫ item** do sum√°rio (apenas o primeiro, com qualidade).
4. **Resumo final**: 5 pontos-chave para memorizar.
5. Pergunte ao final: ‚ÄúDeseja que eu continue para o pr√≥ximo item?‚Äù.

## 3) Elementos opcionais (ativar no m√°ximo 2)
${mustArr.includes('Checklist')?`- **Checklist** de 5 passos para analisar o tema.\n`:''}${mustArr.includes('Tabelas')?`- **1 tabela** comparativa objetiva (cabe√ßalhos claros).\n`:''}${mustArr.includes('Caso concreto')?`- **1 mini-caso** resolvido em 3‚Äì5 linhas (situa√ß√£o ‚Üí enquadramento ‚Üí conclus√£o).\n`:''}${mustArr.includes('Quest√µes')?`- **1 objetiva (com gabarito)** + **1 discursiva curta (com espelho).\n`:''}${mustArr.includes('Compara√ß√µes')?`- **Comparar 1‚Äì2 institutos pr√≥ximos** e real√ßar distin√ß√µes-chave.\n`:''}${mustArr.includes('Exemplos pr√°ticos')?`- **2 exemplos pr√°ticos** breves al√©m do mini-caso.\n`:''}
## 4) Jurisprud√™ncia / s√∫mulas / enunciados ‚Äî Estrat√©gia de pesquisa (${jurisLabel})
${state.juris===0?`- **OMITIR**: n√£o inclua; s√≥ citar se indispens√°vel (com link).`:
`Quando **${jurisLabel}** ‚â† OMITIR, siga antes de escrever:
1) Consultas focadas (2‚Äì3 varia√ß√µes): ${tema} + ("jurisprud√™ncia" OR "s√∫mula" OR "ac√≥rd√£o" OR "leading case" OR "tema repetitivo") e (STF OR STJ OR TST OR TSE).
2) Prioridade de fontes: **ConJur, Migalhas, JOTA, √Çmbito Jur√≠dico, JusBrasil/Artigos, RT online**. **Evitar** sites governamentais (exceto **Planalto** p/ texto legal).
3) Checagem: abrir 2‚Äì3 resultados e confirmar tribunal, n¬∫ do processo/tema/s√∫mula, ano e tese.
4) Rec√™ncia: preferir √∫ltimos 5 anos; se antigo mas dominante, justificar.
5) **Cita√ß√£o com link (obrigat√≥ria)**: sempre cite a fonte com **link** em Markdown. Ex.: *STJ, Tema 1234 ‚Äì Tese X (2019). Fonte: ConJur* [(link)](https://...).
${state.juris===1?`6) Pol√≠tica PANORAMA: 1‚Äì2 itens dominantes com links.`:`6) Pol√≠tica OBRIGAT√ìRIA: 2‚Äì3 itens (‚â•1 leading case/s√∫mula), com links.`}`
}
## 5) Regras de qualidade/seguran√ßa
- Cite lei/artigo apenas quando tiver seguran√ßa; se houver chance de desatualiza√ß√£o, avise e proponha verifica√ß√£o.
- Se faltar dado confi√°vel, diga ‚Äún√£o localizado com seguran√ßa‚Äù e sugira a fonte normativa t√≠pica.
- Se o aluno marcou algo que n√£o se aplica, **explique por que omitiu**.`;

    const useShort = (depthIdx===0);
    return useShort ? short : advanced;
  }

  async function finalizePrompt(){
    await botSay('pensando‚Ä¶', 3000);
    await botSay(`seu prompt est√° pronto para **${state.tema}** ‚úÖ
Toque em **Copiar prompt** e cole na IA (GPT, Gemini, Claude‚Ä¶).`, 800);
    const pre=el('pre'); const prompt=buildPrompt(); pre.textContent=prompt; chat.appendChild(pre);
    const copy=el('button','copy','Copiar prompt');
    copy.addEventListener('click', async ()=>{
      try{
        await navigator.clipboard.writeText(prompt); copy.textContent='Copiado! ‚úÖ';
        await botSay('obrigado por estudar comigo! üíô');
        await showThinking(1800);
        const again=el('button','copy','Nova pesquisa');
        again.addEventListener('click', ()=>{ chat.innerHTML=''; state.tema=''; state.depth=null; state.must.clear(); state.juris=null; greet(); });
        chat.appendChild(again); scrollBottom();
      }catch(e){ copy.textContent='Falhou :('; }
    });
    chat.appendChild(copy); scrollBottom();
  }

  // ===== Entrada =====
  sendBtn.addEventListener('click', async ()=>{
    if(state.phase==='idle' || state.phase==='ask_tema'){
      state.tema = temaInput.value.trim();
      if(!state.tema){ await botSay('me d√° um exemplo, tipo **tutela de urg√™ncia** ou **furto ‚Äì art. 155** üòâ'); return; }
      bubble(state.tema,'user');
      await botSay('beleza. agora me diga o **n√≠vel de profundidade**.');
      state.phase='wizard';
      askDepth();
    }
  });
  temaInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') sendBtn.click(); });

  // ===== Teclado mobile ‚Äî h√≠brido (visualViewport + fallback)
  let BASE = window.innerHeight;
  function setKB(px){
    const v = Math.max(px, 64);
    document.documentElement.style.setProperty('--kb', v + 'px');
    scrollBottom();
  }
  function adjustForKeyboard(){
    try{
      if(window.visualViewport){
        const vv = window.visualViewport;
        const kb = Math.max(0, window.innerHeight - vv.height - vv.offsetTop);
        setKB(kb + 16); return;
      }
      // fallback (iframes / preview)
      const kb = Math.max(0, BASE - window.innerHeight);
      setKB(kb + 16);
    }catch(_){}
  }
  window.addEventListener('resize', adjustForKeyboard);
  if(window.visualViewport){
    visualViewport.addEventListener('resize', adjustForKeyboard);
    visualViewport.addEventListener('scroll', adjustForKeyboard);
  }
  temaInput.addEventListener('focus', ()=>{ setTimeout(adjustForKeyboard, 50); });
  temaInput.addEventListener('blur',  ()=>{ setKB(64); });

  // start
  greet();
  setKB(64);
  </script>
</body>
</html>
